<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Conversiones - Números Complejos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===========================
   Tema: Gris oscuro + Dorado
   Minimal · Modern · Elegante
   Reemplazar el <style> actual por este
   =========================== */

:root{
  --bg: #0f1113;            /* fondo principal */
  --panel: #141517;         /* paneles / tarjetas */
  --panel-2: #1b1b1d;
  --muted: #9aa0a6;         /* texto secundario */
  --text: #efefef;          /* texto principal */
  --gold: #c9a86a;          /* dorado principal */
  --gold-2: #e6c887;        /* brillo */
  --accent-red: #d46b63;    /* para botones limpiar */
  --card-border: rgba(255,255,255,0.03);
  --glass: rgba(255,255,255,0.02);
  --shadow-deep: 0 18px 48px rgba(3,8,12,0.7);
  --radius: 14px;
  --transition: 260ms cubic-bezier(.2,.9,.2,1);
  --panel-edge: linear-gradient(90deg,var(--gold),var(--gold-2));
}

/* -------------------------
   Reset y tipografía
   ------------------------- */
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  background: radial-gradient(1200px 600px at 10% 10%, rgba(201,168,106,0.035), transparent 6%),
              linear-gradient(180deg, #0b0c0d 0%, var(--bg) 100%);
  color:var(--text);
  font-family: Inter, "Segoe UI", Roboto, system-ui, -apple-system, "Poppins", sans-serif;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  padding:34px 18px;
  line-height:1.5;
}

/* -------------------------
   Contenedor principal
   ------------------------- */
.container{
  max-width: 980px;
  margin: 18px auto;
  background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
  border-radius: var(--radius);
  padding: 32px;
  box-shadow: var(--shadow-deep);
  border: 1px solid var(--card-border);
  position: relative;
  overflow: hidden;
}

/* gold top accent */
.container::before{
  content:"";
  position:absolute;
  left:0; right:0; top:0;
  height:5px;
  background: var(--panel-edge);
}

/* -------------------------
   Header
   ------------------------- */
.header-info{
  text-align:center;
  margin-bottom:20px;
  padding-bottom:12px;
  position:relative;
  z-index:2;
}

.header-info h1{
  color:var(--gold);
  font-size:1.05rem;
  letter-spacing:0.6px;
  font-weight:800;
  margin-bottom:10px;
  text-shadow: 0 8px 22px rgba(201,168,106,0.05);
}

.header-info p{
  color:var(--muted);
  font-size:0.95rem;
  margin:6px 0;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
}

/* small decorative underline */
.header-info::after{
  content:"";
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  bottom: -6px;
  width:120px;
  height:3px;
  background: linear-gradient(90deg, rgba(201,168,106,0.35), rgba(230,200,135,0.2));
  border-radius:3px;
  filter:blur(.2px);
}

/* -------------------------
   Section title
   ------------------------- */
.container > h1{
  font-size:1.05rem;
  color:var(--text);
  text-align:center;
  margin: 12px 0 22px 0;
  font-weight:700;
}

/* -------------------------
   Instructions
   ------------------------- */
.instructions{
  background: linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.01));
  padding:18px;
  border-radius:10px;
  margin-bottom:22px;
  border-left: 4px solid rgba(201,168,106,0.14);
  color:var(--muted);
  box-shadow: 0 8px 26px rgba(3,8,12,0.45);
  transition: box-shadow var(--transition), transform var(--transition);
}
.instructions:hover{
  transform: translateY(-4px);
  box-shadow: 0 20px 48px rgba(3,8,12,0.55);
}
.instructions strong{
  color:var(--gold);
  display:flex;
  align-items:center;
  gap:10px;
  margin-bottom:10px;
}

/* list bullets */
.instructions li{ margin-bottom:8px; color:var(--muted); }
.instructions li::marker{ color:var(--gold); }

/* -------------------------
   Form sections (cartesian/polar/exponential)
   ------------------------- */
.form-section{
  margin-bottom:20px;
  border-radius:12px;
  padding:20px;
  position:relative;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));
  border:1px solid rgba(255,255,255,0.02);
  box-shadow: 0 12px 34px rgba(3,8,12,0.45);
  transition: transform var(--transition), box-shadow var(--transition);
  overflow:hidden;
}
.form-section:hover{
  transform: translateY(-6px);
  box-shadow: 0 28px 60px rgba(3,8,12,0.55);
}

/* left gold stripe */
.form-section::before{
  content:"";
  position:absolute;
  left:0; top:0;
  width:6px; height:100%;
  background: linear-gradient(180deg, var(--gold), var(--gold-2));
}

/* section headers */
.form-section h2{
  color:var(--text);
  font-weight:700;
  font-size:1.05rem;
  margin-bottom:16px;
  padding-left: 14px;
  border-left: 4px solid rgba(255,255,255,0.02);
  display:flex; align-items:center; gap:10px;
}
.form-section h2 i{ color:var(--gold); }

/* -------------------------
   Input groups & labels
   ------------------------- */
.input-group{
  display:flex;
  align-items:center;
  gap:12px;
  margin-bottom:16px;
  flex-wrap:wrap;
}
.input-group label{
  min-width:20px;
  font-weight:700;
  color:var(--text);
  font-size:0.96rem;
}
.operator{
  font-size:1rem;
  color:var(--gold);
  margin:0 6px;
  font-weight:700;
}

/* -------------------------
   Text inputs
   ------------------------- */
input[type="text"]{
  width:120px;
  padding:10px 12px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.03);
  background: rgba(255,255,255,0.02);
  color:var(--text);
  font-size:0.98rem;
  text-align:center;
  font-family: 'Courier New', monospace;
  transition: box-shadow var(--transition), transform var(--transition), border-color var(--transition);
  font-weight:600;
}
input[type="text"]::placeholder{ color: rgba(255,255,255,0.26); }
input[type="text"]:focus{
  outline:none;
  border-color: rgba(201,168,106,0.9);
  box-shadow: 0 10px 30px rgba(201,168,106,0.06);
  transform: translateY(-2px);
  background: rgba(255,255,255,0.04);
}

/* readonly inputs */
input[readonly]{
  background: rgba(255,255,255,0.01) !important;
  cursor: default;
  opacity: 0.95;
}

/* -------------------------
   Result boxes
   ------------------------- */
.result{
  background: linear-gradient(90deg, rgba(255,255,255,0.012), rgba(255,255,255,0.02));
  padding:14px;
  border-radius:10px;
  border-left: 4px solid rgba(201,168,106,0.12);
  font-family: 'Courier New', monospace;
  font-size:0.98rem;
  color:var(--text);
  min-height:56px;
  display:flex;
  align-items:center;
  font-weight:700;
  box-shadow: inset 0 4px 10px rgba(3,8,12,0.45);
  transition: transform var(--transition), box-shadow var(--transition);
}
.result:hover{
  transform: translateX(6px);
  box-shadow: inset 0 6px 14px rgba(3,8,12,0.5);
}

/* -------------------------
   Clear button (prominent)
   ------------------------- */
.clear-btn{
  display:block;
  margin:22px auto 0;
  padding:12px 24px;
  border-radius:10px;
  border:none;
  cursor:pointer;
  font-weight:800;
  color:#0b0b0b;
  background: linear-gradient(180deg, var(--gold-2), var(--gold));
  box-shadow: 0 14px 36px rgba(201,168,106,0.12);
  transition: transform var(--transition), box-shadow var(--transition), filter var(--transition);
  position:relative;
  overflow:hidden;
}
.clear-btn:hover{ transform: translateY(-6px); filter:brightness(1.02); box-shadow: 0 24px 46px rgba(201,168,106,0.16); }
.clear-btn:active{ transform: translateY(-2px); }

/* -------------------------
   Preset buttons (neutral)
   ------------------------- */
.preset-btn{
  padding:8px 12px;
  border-radius:999px;
  background: rgba(255,255,255,0.02);
  color:var(--muted);
  border:1px solid rgba(255,255,255,0.02);
  font-weight:700;
  cursor:pointer;
  transition: transform var(--transition), background var(--transition), color var(--transition);
}
.preset-btn:hover{
  transform: translateY(-4px);
  background: rgba(201,168,106,0.06);
  color:var(--gold-2);
  border-color: rgba(201,168,106,0.12);
}

/* -------------------------
   Number line & points
   ------------------------- */
.number-line{
  width:100%;
  height:130px;
  position:relative;
  border-radius:10px;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));
  border:1px solid rgba(255,255,255,0.02);
  margin:18px 0;
  overflow:hidden;
}
.line{
  position:absolute;
  top:62px;
  left:5%;
  right:5%;
  height:3px;
  background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.06) 10%, rgba(255,255,255,0.06) 90%, transparent 100%);
}
.tick{ position:absolute; width:2px; height:20px; background: rgba(255,255,255,0.04); top:52px; }
.tick-label{ position:absolute; top:76px; color:var(--muted); font-size:0.85rem; transform:translateX(-50%); }

/* points */
.number-point{
  position:absolute;
  width:22px; height:22px;
  top:52px;
  transform:translateX(-50%);
  border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  cursor:pointer;
  box-shadow: 0 12px 30px rgba(2,6,8,0.6);
  transition: transform var(--transition), box-shadow var(--transition);
  border:2px solid rgba(255,255,255,0.04);
}
.number-point:hover{ transform: translateX(-50%) scale(1.18); z-index:30; }
.number-point.naturals{ background: linear-gradient(180deg, rgba(212,105,105,0.95), rgba(190,85,85,0.95)); }
.number-point.integers{ background: linear-gradient(180deg, rgba(74,163,224,0.95), rgba(50,140,200,0.95)); }
.number-point.rationals{ background: linear-gradient(180deg, rgba(57,168,106,0.95), rgba(40,140,88,0.95)); }
.number-point.irrationals{ background: linear-gradient(180deg, rgba(243,208,106,0.95), rgba(225,185,80,0.95)); }

/* tooltip label */
.point-label{
  position:absolute;
  top:-40px;
  transform:translateX(-50%);
  background: rgba(20,20,20,0.96);
  color:var(--text);
  padding:6px 10px;
  border-radius:8px;
  font-size:0.82rem;
  font-weight:700;
  border:1px solid rgba(255,255,255,0.03);
  box-shadow: 0 12px 36px rgba(3,8,12,0.6);
  opacity:0;
  pointer-events:none;
}
.number-point:hover .point-label{ opacity:1; }

/* -------------------------
   Panels & lists
   ------------------------- */
.info-panels{ display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap:18px; }
.classification-panel, .points-panel, .distance-calculator{
  border-radius:10px;
  padding:16px;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));
  border:1px solid rgba(255,255,255,0.02);
  box-shadow: 0 12px 34px rgba(3,8,12,0.45);
}
.classification-panel h3, .points-panel h3, .distance-calculator h3{
  color:var(--gold);
  margin-bottom:12px;
  font-weight:800;
}

/* legend item */
.legend-item{ display:flex; align-items:center; gap:12px; margin:8px 0; padding:8px; border-radius:8px; background: rgba(255,255,255,0.01); border:1px solid rgba(255,255,255,0.01); }
.legend-color{ width:20px; height:20px; border-radius:50%; border:2px solid rgba(255,255,255,0.03); box-shadow: 0 8px 24px rgba(3,8,12,0.45); }
.legend-color.naturals{ background:var(--accent-red); }
.legend-color.integers{ background:var(--accent-red); } /* keep colorful for readability */
.legend-color.rationals{ background:var(--accent-red); }
.legend-color.irrationals{ background:var(--accent-red); }

/* point items */
.point-item{
  display:flex; justify-content:space-between; align-items:center;
  padding:12px; margin:10px 0; border-radius:8px;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.015));
  border-left:4px solid rgba(255,255,255,0.02);
  transition: transform var(--transition), box-shadow var(--transition);
}
.point-item:hover{ transform: translateX(8px); box-shadow: 0 18px 40px rgba(3,8,12,0.55); }

/* empty state */
.empty-state p{ color:var(--muted); text-align:center; margin:18px 0; }

/* distance result */
.distance-placeholder{ text-align:center; padding:22px; border-radius:8px; border:2px dashed rgba(255,255,255,0.03); color:var(--muted); background: rgba(255,255,255,0.01); }
.distance-result{ padding:18px; border-radius:8px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.015)); border:1px solid rgba(255,255,255,0.02); color:var(--text); text-align:center; font-weight:800; }

/* custom select */
.custom-select{ position:relative; width:100%; max-width:400px; }
.select-selected{ padding:12px 14px; border-radius:10px; cursor:pointer; font-weight:800; background: rgba(255,255,255,0.01); border:1px solid rgba(255,255,255,0.02); color:var(--muted); }
.select-items{ position:absolute; left:0; right:0; top:100%; margin-top:6px; background: rgba(18,18,18,0.98); border-radius:10px; overflow:hidden; box-shadow: 0 12px 40px rgba(3,8,12,0.6); display:none; z-index:60; border:1px solid rgba(255,255,255,0.03); }
.select-items.show{ display:block; }
.select-items div{ padding:12px 14px; cursor:pointer; color:var(--muted); transition: background var(--transition); }
.select-items div:hover{ background: rgba(201,168,106,0.06); color:var(--gold-2); }

/* -------------------------
   Math icon decorations
   ------------------------- */
.math-icon{ position:absolute; opacity:0.035; font-size:120px; z-index:0; filter: drop-shadow(0 12px 28px rgba(0,0,0,0.6)); }
.icon-1{ top:40px; right:28px; color:var(--gold-2); }
.icon-2{ bottom:90px; left:28px; color:var(--gold-2); }
.icon-3{ bottom:38px; right:46px; color:var(--gold-2); }

/* -------------------------
   Responsive tweaks
   ------------------------- */
@media (max-width:800px){
  body{ padding:18px; }
  .container{ padding:20px; }
  input[type="text"]{ width:96px; }
  .number-line{ height:110px; }
  .math-icon{ display:none; }
  .point-item{ flex-direction:column; align-items:flex-start; gap:8px; }
  .clear-btn{ width:100%; }
}

/* -------------------------
   Animations
   ------------------------- */
@keyframes fadeIn {
  from{ opacity:0; transform: translateY(12px); }
  to{ opacity:1; transform: translateY(0); }
}
.form-section, .instructions, .header-info{
  animation: fadeIn 420ms ease both;
}
.point-item{ animation: fadeIn 360ms ease both; }

    </style>
</head>
<body>
    <div class="container">
        <i class="fas fa-square-root-alt math-icon icon-1"></i>
        <i class="fas fa-divide math-icon icon-2"></i>
        <i class="fas fa-infinity math-icon icon-3"></i>
        
        <div class="header-info">
            <h1><i class="fas-calculator"></i> Instituto Tecnológico de Software</h1>
            <p><i class="fas fa-book"></i> <strong>Materia:</strong> Fundamentos de Álgebra</p>
            <p><i class="fas fa-chalkboard-teacher"></i> <strong>Docente:</strong> Jorge Javier Pedrozo</p>
            <p><i class="fas fa-user-graduate"></i> <strong>Alumno:</strong> Fabrizio Rodriguez</p>
            <p><i class="fas fa-users"></i> <strong>Grupo:</strong> 1°A</p>
        </div>
        
        <h1 style="text-align: center; margin-bottom: 20px; color: var(--dark);">
            <i class="fas fa-calculator"></i> Calculadora de Conversiones de Números Complejos
        </h1>

        <div class="instructions">
            <strong><i class="fas fa-info-circle"></i> Instrucciones:</strong>
            <ul>
                <li>Ingresa un número complejo en cualquiera de las tres formas</li>
                <li>Las otras formas se calcularán automáticamente</li>
                <li>Los ángulos se expresan en radianes y en múltiplos de pi cuando es posible</li>
                <li>Para ángulos puedes usar: pi, pi/2, pi/4, pi/3, pi/6, 2*pi, etc.</li>
                <li>Para raíces cuadradas puedes usar: sqrt(2), sqrt(3), sqrt(5), etc.</li>
                <li>Usa números decimales (ejemplo: 1.5, -2.7, 0.5)</li>
            </ul>
        </div>

        <!-- Forma Cartesiana -->
        <div class="form-section">
            <h2><i class="fas fa-plus-circle"></i> Forma Cartesiana: a + bi</h2>
            <div class="input-group">
                <label>z =</label>
                <input type="text" id="real" placeholder="a (ej: sqrt(2))">
                <span class="operator">+</span>
                <input type="text" id="imag" placeholder="b (ej: sqrt(3))">
                <span class="operator">i</span>
            </div>
            <div class="result" id="cartesian-result">Ingresa los valores arriba</div>
        </div>

        <!-- Forma Polar -->
        <div class="form-section">
            <h2><i class="fas fa-dot-circle"></i> Forma Polar: r(cos θ + i sin θ)</h2>
            <div class="input-group">
                <label>z =</label>
                <input type="text" id="modulus" placeholder="r (ej: sqrt(2))">
                <span class="operator">(cos</span>
                <input type="text" id="angle" placeholder="θ (ej: pi/2)">
                <span class="operator">+ i sin</span>
                <input type="text" id="angle2" placeholder="θ" readonly>
                <span class="operator">)</span>
            </div>
            <div class="result" id="polar-result">Ingresa los valores arriba</div>
        </div>

        <!-- Forma Exponencial -->
        <div class="form-section">
            <h2><i class="fas fa-superscript"></i> Forma Exponencial: re^(iθ)</h2>
            <div class="input-group">
                <label>z =</label>
                <input type="text" id="exp-modulus" placeholder="r (ej: sqrt(5))">
                <span class="operator">e^(i*</span>
                <input type="text" id="exp-angle" placeholder="θ (ej: pi/4)">
                <span class="operator">)</span>
            </div>
            <div class="result" id="exponential-result">Ingresa los valores arriba</div>
        </div>

        <button class="clear-btn" onclick="clearAll()"><i class="fas fa-broom"></i> Limpiar Todo</button>
    </div>

    <script>
        /* ======================== VARIABLES GLOBALES ===================== */ 
        let isUpdating = false; // Previene bucles infinitos durante actualizaciones
        
        /* ======================== FUNCIONES DE PARSEO ===================== */ 
        /**
         * Convierte una cadena de texto a número, soportando expresiones matemáticas
         */
        function parseNumber(input) {
            // Manejar casos vacíos o nulos
            if (!input && input !== 0) return 0;

            const inputStr = input.toString().trim();
            if (!inputStr) return 0;

            // Preparar expresión reemplazando funciones matemáticas
            let expression = inputStr
                .replace(/sqrt\s*\(/gi, 'Math.sqrt(')  // sqrt(2) → Math.sqrt(2)
                .replace(/pi\b/gi, 'Math.PI');    // pi → Math.PI

            try {
                // Evaluar expresión de forma segura
                const result = Function("'use strict'; return (" + expression + ")")();
                // Verificar que el resultado sea válido
                if (isNaN(result) || !isFinite(result)) {
                    return 0;
                }
                return result;
            } catch (error) {
                // En caso de error, retornar 0
                return 0;
            }
        }

        /**
         * Convierte una cadena de texto a ángulo en radianes
         */
        function parseAngle(input) {
            return parseNumber(input); // Usa la misma lógica que parseNumber
        }

        /* ========================= FUNCIONES DE FORMATO ===================== */ 
        /** 
         * Convierte un ángulo en radianes a su representación en múltiples de pi 
         */
        function angleToPI(angle) {
            if (Math.abs(angle) < 1e-8) return "0";

            // Múltiples comunes de pi
            const piMultiples = [
                { value: Math.PI, text: "pi" },
                { value: Math.PI/2, text: "pi/2" },
                { value: Math.PI/3, text: "pi/3" },
                { value: Math.PI/4, text: "pi/4" },
                { value: Math.PI/6, text: "pi/6" },
                { value: 2*Math.PI, text: "2*pi" },
                { value: 3*Math.PI/2, text: "3*pi/2" },
                { value: 2*Math.PI/3, text: "2*pi/3" },
                { value: 3*Math.PI/4, text: "3*pi/4" },
                { value: 5*Math.PI/6, text: "5*pi/6" },
                { value: 5*Math.PI/4, text: "5*pi/4" },
                { value: 4*Math.PI/3, text: "4*pi/3" },
                { value: 5*Math.PI/3, text: "5*pi/3" },
                { value: 7*Math.PI/4, text: "7*pi/4" },
                // Valores negativos
                { value: -Math.PI, text: "-pi" },
                { value: -Math.PI/2, text: "-pi/2" },
                { value: -Math.PI/3, text: "-pi/3" },
                { value: -Math.PI/4, text: "-pi/4" },
                { value: -Math.PI/6, text: "-pi/6" }
            ];

            // Buscar coincidencia exacta
            for (let pm of piMultiples) {
                if (Math.abs(angle - pm.value) < 1e-8) {
                    return pm.text;
                }
            }

            // Intentar expresar como fracción de pi
            const ratio = angle / Math.PI;

            // Múltiplo entero de pi
            if (Math.abs(ratio - Math.round(ratio)) < 1e-8) {
                const intRatio = Math.round(ratio);
                if (intRatio === 1) return "pi";
                if (intRatio === -1) return "-pi";
                if (intRatio === 0) return "0";
                return intRatio + "*pi";
            }

            // Fracciones simples de pi
            const denominators = [2, 3, 4, 6, 8, 12];
            for (let den of denominators) {
                const num = ratio * den;
                if (Math.abs(num - Math.round(num)) < 1e-8) {
                    const intNum = Math.round(num);
                    if (intNum === 0) return "0";
                    if (den === 1) {
                        return intNum === 1 ? "pi" : intNum === -1 ? "-pi" : intNum + "*pi";
                    }
                    if (intNum === 1) return "pi/" + den;
                    if (intNum === -1) return "-pi/" + den;
                    return intNum + "*pi/" + den;
                }
            }

            // Si no se puede expresar como múltiplo de pi, usar decimal
            return angle.toFixed(6);
        }

        /**
         * Formatea un número mostrando fracciones y raíces cuando sea posible
         */
        function formatNumber(num) {
            if (Math.abs(num) < 1e-10) return "0";
            
            // Raíces cuadradas comunes
            const sqrtValues = [
                { value: Math.sqrt(2), text: "√2" },
                { value: Math.sqrt(3), text: "√3" },
                { value: Math.sqrt(5), text: "√5" },
                { value: Math.sqrt(6), text: "√6" },
                { value: Math.sqrt(7), text: "√7" },
                { value: Math.sqrt(8), text: "2√2" },
                { value: Math.sqrt(2)/2, text: "√2/2" },
                { value: Math.sqrt(3)/2, text: "√3/2" },
                { value: Math.sqrt(3)/3, text: "√3/3" },
                { value: -Math.sqrt(2), text: "-√2" },
                { value: -Math.sqrt(3), text: "-√3" },
                { value: -Math.sqrt(2)/2, text: "-√2/2" },
                { value: -Math.sqrt(3)/2, text: "-√3/2" }
            ];

            // Verificar raíces
            for (let sv of sqrtValues) {
                if (Math.abs(num - sv.value) < 1e-8) {
                    return sv.text;
                }
            }

            // Fracciones comunes
            const fractions = [
                { value: 1/2, text: "1/2" },
                { value: 1/3, text: "1/3" },
                { value: 2/3, text: "2/3" },
                { value: 1/4, text: "1/4" },
                { value: 3/4, text: "3/4" },
                { value: 1/6, text: "1/6" },
                { value: 5/6, text: "5/6" },
                { value: -1/2, text: "-1/2" },
                { value: -1/3, text: "-1/3" },
                { value: -2/3, text: "-2/3" }
            ];

            // Verificar fracciones
            for (let frac of fractions) {
                if (Math.abs(num - frac.value) < 1e-8) {
                    return frac.text;
                }
            }

            // Enteros
            if (Math.abs(num - Math.round(num)) < 1e-8) {
                return Math.round(num).toString();
            }

            // Decimal con precisión limitada
            return parseFloat(num.toFixed(6)).toString();
        }

        /**
         * Normaliza un ángulo al rango (-π, π]
         */
        function normalizeAngle(angle) {
            while (angle > Math.PI) angle -= 2 * Math.PI;
            while (angle <= -Math.PI) angle += 2 * Math.PI;
            return angle;
        }

        /* ========================= FUNCIONES DE CONVERSIÓN ========================= */
        /**
         * Actualiza todas las formas cuando se modifica la forma cartesiana
         */
        function updateFromCartesian() {
            if (isUpdating) return;
            isUpdating = true;

            // Obtener valores de los campos
            const real = parseNumber(document.getElementById('real').value) || 0;
            const imag = parseNumber(document.getElementById('imag').value) || 0;

            // Calcular módulo y argumento
            const modulus = Math.sqrt(real * real + imag * imag);
            let angle = Math.atan2(imag, real);
            angle = normalizeAngle(angle);

            // Actualizar forma polar
            const modulusFormatted = formatNumber(modulus);
            const angleFormatted = angleToPI(angle);

            document.getElementById('modulus').value = modulusFormatted;
            document.getElementById('angle').value = angleFormatted;
            document.getElementById('angle2').value = angleFormatted;

            // Actualizar forma exponencial
            document.getElementById('exp-modulus').value = modulusFormatted;
            document.getElementById('exp-angle').value = angleFormatted;

            // Actualizar resultados mostrados
            updateResults(real, imag, modulus, angle);

            isUpdating = false;
        }

        /**
         * Actualiza todas las formas cuando se modifica la forma polar
         */
        function updateFromPolar() {
            if (isUpdating) return;
            isUpdating = true;

            // Obtener valores de los campos
            const modulus = parseNumber(document.getElementById('modulus').value) || 0;
            const angle = parseAngle(document.getElementById('angle').value) || 0;
            const normalizedAngle = normalizeAngle(angle);

            // Sincronizar segundo campo de ángulo
            const angleFormatted = angleToPI(normalizedAngle);
            document.getElementById('angle2').value = angleFormatted;

            // Calcular coordenadas cartesianas
            const real = modulus * Math.cos(normalizedAngle);
            const imag = modulus * Math.sin(normalizedAngle);

            // Actualizar forma cartesiana
            document.getElementById('real').value = formatNumber(real);
            document.getElementById('imag').value = formatNumber(imag);

            // Actualizar forma exponencial
            document.getElementById('exp-modulus').value = formatNumber(modulus);
            document.getElementById('exp-angle').value = angleFormatted;

            // Actualizar resultados mostrados
            updateResults(real, imag, modulus, normalizedAngle);

            isUpdating = false;
        }

        /**
         * Actualiza todas las formas cuando se modifica la forma exponencial
         */
        function updateFromExponential() {
            if (isUpdating) return;
            isUpdating = true;

            // Obtener valores de los campos
            const modulus = parseNumber(document.getElementById('exp-modulus').value) || 0;
            const angle = parseAngle(document.getElementById('exp-angle').value) || 0;
            const normalizedAngle = normalizeAngle(angle);

            // Calcular coordenadas cartesianas
            const real = modulus * Math.cos(normalizedAngle);
            const imag = modulus * Math.sin(normalizedAngle);

            // Actualizar forma cartesiana
            document.getElementById('real').value = formatNumber(real);
            document.getElementById('imag').value = formatNumber(imag);

            // Actualizar forma polar
            const angleFormatted = angleToPI(normalizedAngle);
            document.getElementById('modulus').value = formatNumber(modulus);
            document.getElementById('angle').value = angleFormatted;
            document.getElementById('angle2').value = angleFormatted;

            // Actualizar resultados mostrados
            updateResults(real, imag, modulus, normalizedAngle);

            isUpdating = false;
        }

        /**
         * Actualiza los resultados mostrados en todas las secciones
         */
        function updateResults(real, imag, modulus, angle) {
            const angleText = angleToPI(angle);

            // Resultado cartesiano
            let cartesianText = "";
            if (real !== 0 || imag !== 0) {
                if (real !== 0) {
                    cartesianText += formatNumber(real);
                }
                if (imag > 0) {
                    cartesianText += (real !== 0 ? " + " : "");
                    if (imag === 1) {
                        cartesianText += "i";
                    } else {
                        cartesianText += formatNumber(imag) + "i";
                    }
                } else if (imag < 0) {
                    cartesianText += " - ";
                    if (imag === -1) {
                        cartesianText += "i";
                    } else {
                        cartesianText += formatNumber(-imag) + "i";
                    }
                }
                if (cartesianText === "") cartesianText = "0";
            } else {
                cartesianText = "0";
            }
            document.getElementById('cartesian-result').textContent = "z = " + cartesianText;

            // Resultado polar
            let polarText = "";
            if (modulus !== 0) {
                polarText = formatNumber(modulus) + "(cos(" + angleText + ") + i sin(" + angleText + "))";
            } else {
                polarText = "0";
            }
            document.getElementById('polar-result').textContent = "z = " + polarText;

            // Resultado exponencial
            let expText = "";
            if (modulus !== 0) {
                expText = formatNumber(modulus) + "e^(i*" + angleText + ")";
            } else {
                expText = "0";
            }
            document.getElementById('exponential-result').textContent = "z = " + expText;
        }

        /* ========================= FUNCIONES AUXILIARES ===================== */ 
        /**
         * Limpia todos los campos de entrada y resultados
         */
        function clearAll() {
            // Limpiar todos los campos de entrada
            const inputs = document.querySelectorAll('input[type="text"]');
            inputs.forEach(input => {
                if (!input.readOnly) {
                    input.value = "";
                }
            });
            
            // Limpiar todos los resultados
            const results = document.querySelectorAll('.result');
            results.forEach(result => result.textContent = 'Ingresa los valores arriba');
            
            console.log('Todos los campos limpiados');
        }

        /* ========================= CONFIGURACIÓN DE EVENTOS ===================== */
        /**
         * Configura los event listeners cuando el DOM está listo
         */
        document.addEventListener('DOMContentLoaded', function() {
            // Event listeners para forma cartesiana
            document.getElementById('real').addEventListener('input', updateFromCartesian);
            document.getElementById('imag').addEventListener('input', updateFromCartesian);

            // Event listeners para forma polar
            document.getElementById('modulus').addEventListener('input', updateFromPolar);
            document.getElementById('angle').addEventListener('input', function() {
                document.getElementById('angle').value = this.value;
                updateFromPolar();
            });

            // Event listeners para forma exponencial
            document.getElementById('exp-modulus').addEventListener('input', updateFromExponential);
            document.getElementById('exp-angle').addEventListener('input', updateFromExponential);

            // Event listeners para tecla Enter en cualquier campo
            const inputs = document.querySelectorAll('input[type="text"]');
            inputs.forEach(input => {
                if (!input.readOnly) {
                    input.addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') {
                            input.blur(); // Quitar foco para activar el evento input
                        }
                    });
                }
            });
            
            console.log('Event listeners configurados correctamente');
            console.log('Calculadora de números complejos lista para usar');
        });
    </script>
</body>
</html>