<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Visualizador de la Recta Num√©rica - Fundamentos de √Ålgebra</title>
  
  <style>
    /* ==================== RESET MEJORADO Y TIPOGRAF√çA ==================== */
    :root {
      --bg: #0f1113;
      --panel: #151617;
      --muted: #9aa0a6;
      --text: #ececec;
      --gold: #c9a86a;
      --gold-bright: #e6c887;
      --card-border: rgba(255,255,255,0.03);
      --glass: rgba(255,255,255,0.02);
      --shadow: 0 12px 36px rgba(2,6,10,0.6);
      --radius: 14px;
      --accent-1: #dd6b6b;
      --accent-2: #4aa3e0;
      --accent-3: #39a86a;
      --accent-4: #f3d06a;
      --transition: 260ms cubic-bezier(.2,.9,.2,1);
      --success: #27ae60;
      --error: #e74c3c;
      --warning: #f39c12;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }
    body {
      background: linear-gradient(180deg, #0c0d0e 0%, var(--bg) 100%);
      color: var(--text);
      font-family: 'Inter', 'Segoe UI', Roboto, system-ui, -apple-system, 'Poppins', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      padding: 20px;
      line-height: 1.5;
      overflow-x: hidden;
    }

    /* ------------------------- Contenedor principal ------------------------- */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius: var(--radius);
      padding: 30px;
      box-shadow: var(--shadow);
      border: 1px solid var(--card-border);
      position: relative;
      overflow: hidden;
    }

    .container::before {
      content: "";
      position: absolute;
      left: 0; right: 0; top: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--gold), var(--gold-bright));
    }

    /* ------------------------- Encabezados ------------------------- */
    h1 {
      font-size: 2.2rem;
      color: var(--gold);
      letter-spacing: 0.6px;
      margin-bottom: 15px;
      text-align: center;
      text-shadow: 0 6px 18px rgba(201,168,106,0.06);
    }

    h2 {
      font-size: 1.4rem;
      color: var(--text);
      margin-bottom: 20px;
      font-weight: 600;
      position: relative;
      padding-bottom: 10px;
    }

    h2::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--gold), transparent);
    }

    h3 {
      font-size: 1.1rem;
      color: var(--text);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    h3::before {
      content: "‚ñ∂";
      color: var(--gold);
      font-size: 0.8rem;
      opacity: 0.8;
    }

    /* ------------------------- Controles ------------------------- */
    .controls {
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      border: 1px solid rgba(255,255,255,0.02);
      box-shadow: 0 6px 18px rgba(2,6,8,0.45);
      transition: all var(--transition);
    }

    .controls:hover {
      transform: translateY(-2px);
      box-shadow: 0 16px 36px rgba(2,6,8,0.5);
    }

    .input-group {
      margin-bottom: 20px;
    }

    .input-group label {
      display: block;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 8px;
      font-size: 0.95rem;
    }

    .input-group input {
      width: 100%;
      max-width: 500px;
      padding: 12px 16px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.04);
      background: rgba(255,255,255,0.01);
      color: var(--text);
      font-size: 1rem;
      transition: all var(--transition);
    }

    .input-group input:focus {
      outline: none;
      border-color: rgba(201,168,106,0.9);
      box-shadow: 0 8px 30px rgba(201,168,106,0.06);
      transform: translateY(-1px);
    }

    /* ------------------------- Botones ------------------------- */
    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
    }

    button {
      padding: 12px 24px;
      font-size: 0.95rem;
      font-weight: 600;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      transition: all var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: linear-gradient(180deg, var(--gold-bright), var(--gold));
      color: #0b0b0b;
      box-shadow: 0 8px 20px rgba(201,168,106,0.12);
    }

    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 25px rgba(201,168,106,0.2);
    }

    .btn-secondary {
      background: transparent;
      color: var(--muted);
      border: 1px solid rgba(255,255,255,0.03);
    }

    .btn-secondary:hover {
      background: rgba(201,168,106,0.08);
      color: var(--gold-bright);
      transform: translateY(-2px);
    }

    .btn-small {
      padding: 6px 12px;
      font-size: 0.85rem;
    }

    /* ------------------------- Presets ------------------------- */
    .preset-section {
      margin-top: 25px;
      padding-top: 20px;
      border-top: 1px solid rgba(255,255,255,0.02);
    }

    .preset-numbers {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
    }

    .preset-btn {
      padding: 8px 16px;
      border-radius: 20px;
      background: rgba(255,255,255,0.02);
      border: 1px solid rgba(255,255,255,0.03);
      color: var(--muted);
      cursor: pointer;
      transition: all var(--transition);
      font-size: 0.9rem;
    }

    .preset-btn:hover {
      background: rgba(201,168,106,0.1);
      color: var(--gold-bright);
      border-color: rgba(201,168,106,0.2);
      transform: translateY(-2px);
    }

    /* ------------------------- Recta Num√©rica ------------------------- */
    .number-line-container {
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      border: 1px solid rgba(255,255,255,0.02);
      box-shadow: 0 10px 30px rgba(2,6,8,0.45);
    }

    .number-line-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .zoom-controls {
      display: flex;
      gap: 10px;
    }

    .number-line {
      width: 100%;
      height: 140px;
      position: relative;
      border-radius: 10px;
      background: rgba(10,12,14,0.5);
      border: 1px solid rgba(255,255,255,0.02);
      margin: 20px 0;
      overflow: hidden;
    }

    .line {
      position: absolute;
      top: 70px;
      left: 5%;
      right: 5%;
      height: 3px;
      background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.1) 10%, rgba(255,255,255,0.1) 90%, transparent 100%);
    }

    .tick {
      position: absolute;
      width: 2px;
      height: 20px;
      background: rgba(255,255,255,0.1);
      top: 60px;
    }

    .tick-label {
      position: absolute;
      top: 85px;
      font-size: 0.85rem;
      color: var(--muted);
      transform: translateX(-50%);
      font-weight: 500;
    }

    .tick-label.main {
      font-weight: 600;
      color: var(--text);
    }

    /* ------------------------- Puntos ------------------------- */
    .number-point {
      position: absolute;
      width: 24px;
      height: 24px;
      top: 58px;
      transform: translateX(-50%);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(2,6,8,0.5);
      transition: all var(--transition);
      border: 2px solid rgba(255,255,255,0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }

    .number-point:hover {
      transform: translateX(-50%) scale(1.25);
      z-index: 100;
    }

    .number-point.naturals {
      background: linear-gradient(180deg, var(--accent-1), rgba(221,107,107,0.8));
    }
    .number-point.integers {
      background: linear-gradient(180deg, var(--accent-2), rgba(74,163,224,0.8));
    }
    .number-point.rationals {
      background: linear-gradient(180deg, var(--accent-3), rgba(57,168,106,0.8));
    }
    .number-point.irrationals {
      background: linear-gradient(180deg, var(--accent-4), rgba(243,208,106,0.8));
    }

    .point-label {
      position: absolute;
      top: -40px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(20,20,20,0.98);
      color: var(--text);
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 0.85rem;
      font-weight: 600;
      border: 1px solid rgba(255,255,255,0.05);
      box-shadow: 0 10px 30px rgba(2,6,8,0.6);
      opacity: 0;
      pointer-events: none;
      transition: opacity var(--transition);
      white-space: nowrap;
      z-index: 1000;
    }

    .number-point:hover .point-label {
      opacity: 1;
    }

    .point-value {
      font-size: 0.7rem;
      color: white;
      font-weight: bold;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }

    /* ------------------------- Paneles ------------------------- */
    .info-panels {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 25px;
      margin-top: 20px;
    }

    .panel {
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));
      border-radius: 12px;
      padding: 25px;
      border: 1px solid rgba(255,255,255,0.02);
      box-shadow: 0 8px 30px rgba(2,6,8,0.45);
    }

    .panel h3 {
      color: var(--gold);
      margin-bottom: 20px;
      font-size: 1.2rem;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 15px 0;
      padding: 10px;
      border-radius: 8px;
      background: rgba(255,255,255,0.01);
      transition: all var(--transition);
    }

    .legend-item:hover {
      background: rgba(255,255,255,0.02);
      transform: translateX(5px);
    }

    .legend-color {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid rgba(255,255,255,0.1);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    .points-list {
      max-height: 300px;
      overflow-y: auto;
      padding-right: 10px;
    }

    .points-list::-webkit-scrollbar {
      width: 6px;
    }

    .points-list::-webkit-scrollbar-track {
      background: rgba(255,255,255,0.02);
      border-radius: 3px;
    }

    .points-list::-webkit-scrollbar-thumb {
      background: var(--gold);
      border-radius: 3px;
    }

    .point-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 15px;
      margin: 8px 0;
      border-radius: 8px;
      background: rgba(255,255,255,0.01);
      border-left: 4px solid;
      transition: all var(--transition);
    }

    .point-item:hover {
      background: rgba(255,255,255,0.02);
      transform: translateX(5px);
    }

    .point-item.naturals { border-left-color: var(--accent-1); }
    .point-item.integers { border-left-color: var(--accent-2); }
    .point-item.rationals { border-left-color: var(--accent-3); }
    .point-item.irrationals { border-left-color: var(--accent-4); }

    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: var(--muted);
    }

    .empty-state i {
      font-size: 2rem;
      margin-bottom: 15px;
      opacity: 0.5;
    }

    /* ------------------------- Calculadora ------------------------- */
    .distance-calculator .distance-inputs {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }

    .custom-select {
      position: relative;
      width: 100%;
    }

    .select-selected {
      padding: 12px 16px;
      border-radius: 8px;
      background: rgba(255,255,255,0.01);
      border: 1px solid rgba(255,255,255,0.03);
      color: var(--text);
      cursor: pointer;
      transition: all var(--transition);
    }

    .select-selected:hover {
      background: rgba(255,255,255,0.02);
    }

    .select-items {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(20,20,20,0.98);
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.05);
      box-shadow: 0 15px 40px rgba(2,6,8,0.7);
      display: none;
      z-index: 1000;
      max-height: 200px;
      overflow-y: auto;
    }

    .select-items.show {
      display: block;
    }

    .select-items div {
      padding: 12px 16px;
      cursor: pointer;
      color: var(--muted);
      transition: all var(--transition);
      border-bottom: 1px solid rgba(255,255,255,0.02);
    }

    .select-items div:last-child {
      border-bottom: none;
    }

    .select-items div:hover {
      background: rgba(201,168,106,0.1);
      color: var(--gold-bright);
    }

    .distance-result {
      margin-top: 25px;
      padding: 20px;
      border-radius: 10px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.03);
      text-align: center;
      animation: fadeIn 0.5s ease;
    }

    .distance-result h4 {
      color: var(--gold);
      margin-bottom: 10px;
    }

    /* ------------------------- Toast Notifications ------------------------- */
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 25px;
      border-radius: 10px;
      background: rgba(20,20,20,0.95);
      border: 1px solid rgba(255,255,255,0.05);
      box-shadow: 0 10px 30px rgba(2,6,8,0.7);
      color: white;
      z-index: 10000;
      transform: translateX(150%);
      transition: transform 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .toast.show {
      transform: translateX(0);
    }

    .toast.success {
      border-left: 4px solid var(--success);
    }

    .toast.error {
      border-left: 4px solid var(--error);
    }

    .toast.info {
      border-left: 4px solid var(--accent-2);
    }

    /* ------------------------- Responsive ------------------------- */
    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }
      
      h1 {
        font-size: 1.8rem;
      }
      
      .info-panels {
        grid-template-columns: 1fr;
      }
      
      .distance-calculator .distance-inputs {
        grid-template-columns: 1fr;
      }
      
      .button-group {
        flex-direction: column;
      }
      
      button {
        width: 100%;
        justify-content: center;
      }
    }

    /* ------------------------- Animaciones ------------------------- */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes slideIn {
      from { transform: translateX(-20px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .fade-in {
      animation: fadeIn 0.5s ease;
    }

    .slide-in {
      animation: slideIn 0.3s ease;
    }

    /* ------------------------- Estilos de utilidad ------------------------- */
    .mb-20 { margin-bottom: 20px; }
    .mt-20 { margin-top: 20px; }
    .text-center { text-align: center; }
    .text-muted { color: var(--muted); }
    .flex { display: flex; }
    .items-center { align-items: center; }
    .justify-between { justify-content: space-between; }
    .gap-10 { gap: 10px; }
    .gap-20 { gap: 20px; }
  </style>
</head>
<body>
  <div class="container">
    <!-- Encabezado -->
    <header class="text-center mb-20">
      <h1>üìê Visualizador de la Recta Num√©rica</h1>
      <p class="text-muted">Explora y visualiza n√∫meros reales en la recta num√©rica con clasificaci√≥n autom√°tica</p>
    </header>

    <!-- Controles de entrada -->
    <section class="controls">
      <h2>‚ûï Agregar N√∫meros</h2>
      
      <div class="input-group">
        <label for="numberInput">
          <strong>Ingresa un n√∫mero o expresi√≥n matem√°tica:</strong>
        </label>
        <input 
          type="text" 
          id="numberInput" 
          placeholder="Ejemplos: sqrt(7), 2*œÄ, ‚àö2, 1/3, e^2, -5.75"
          autocomplete="off"
        />
        <p class="text-muted" style="margin-top: 8px; font-size: 0.9rem;">
          Soporta: fracciones (1/2), ra√≠ces (‚àö2, sqrt(3)), constantes (œÄ, e, œÜ), expresiones (2*œÄ, e^2)
        </p>
      </div>

      <div class="button-group">
        <button class="btn-primary" onclick="addNumber()">
          <span>‚ûï</span> Agregar N√∫mero
        </button>
        <button class="btn-secondary" onclick="clearAll()">
          <span>üóëÔ∏è</span> Limpiar Todo
        </button>
        <button class="btn-secondary" onclick="showExamples()">
          <span>‚ùì</span> Ver Ejemplos
        </button>
      </div>

      <!-- N√∫meros predefinidos -->
      <div class="preset-section">
        <h3>N√∫meros Predefinidos</h3>
        <p class="text-muted">Haz clic para agregar autom√°ticamente:</p>
        
        <div class="preset-numbers">
          <span class="preset-btn" onclick="addPresetNumber('œÄ')">œÄ</span>
          <span class="preset-btn" onclick="addPresetNumber('e')">e</span>
          <span class="preset-btn" onclick="addPresetNumber('œÜ')">œÜ</span>
          <span class="preset-btn" onclick="addPresetNumber('‚àö2')">‚àö2</span>
          <span class="preset-btn" onclick="addPresetNumber('‚àö3')">‚àö3</span>
          <span class="preset-btn" onclick="addPresetNumber('‚àö5')">‚àö5</span>
          <span class="preset-btn" onclick="addPresetNumber('1/2')">¬Ω</span>
          <span class="preset-btn" onclick="addPresetNumber('1/3')">‚Öì</span>
          <span class="preset-btn" onclick="addPresetNumber('2/3')">‚Öî</span>
          <span class="preset-btn" onclick="addPresetNumber('-‚àö2')">-‚àö2</span>
          <span class="preset-btn" onclick="addPresetNumber('2*œÄ')">2œÄ</span>
          <span class="preset-btn" onclick="addPresetNumber('œÄ/2')">œÄ/2</span>
          <span class="preset-btn" onclick="addPresetNumber('e^2')">e¬≤</span>
        </div>
      </div>
    </section>

    <!-- Recta num√©rica -->
    <section class="number-line-container">
      <div class="number-line-header">
        <h2>üìà Recta Num√©rica Interactiva</h2>
        <div class="zoom-controls">
          <button class="btn-secondary btn-small" onclick="zoomOut()">
            <span>üîç</span> -
          </button>
          <span class="text-muted" style="margin: 0 10px; display: flex; align-items: center;">
            Rango: ¬±<span id="rangeValue">10</span>
          </span>
          <button class="btn-secondary btn-small" onclick="zoomIn()">
            <span>üîç</span> +
          </button>
        </div>
      </div>
      
      <div class="number-line" id="numberLine">
        <!-- L√≠nea y puntos se generan din√°micamente -->
      </div>
      
      <p class="text-center text-muted" style="margin-top: 15px;">
        <small>Haz clic en cualquier punto para eliminarlo ‚Ä¢ Arrastra para mover (pr√≥ximamente)</small>
      </p>
    </section>

    <!-- Paneles informativos -->
    <div class="info-panels">
      <!-- Panel de clasificaci√≥n -->
      <div class="panel">
        <h3>üé® Clasificaci√≥n de N√∫meros</h3>
        <div class="classification-legend">
          <div class="legend-item">
            <div class="legend-color" style="background: var(--accent-1);"></div>
            <div>
              <strong>‚Ñï - Naturales</strong>
              <p class="text-muted" style="font-size: 0.9rem; margin-top: 4px;">
                {1, 2, 3, 4, ...} ‚Ä¢ Enteros positivos
              </p>
            </div>
          </div>
          
          <div class="legend-item">
            <div class="legend-color" style="background: var(--accent-2);"></div>
            <div>
              <strong>‚Ñ§ - Enteros</strong>
              <p class="text-muted" style="font-size: 0.9rem; margin-top: 4px;">
                {..., -2, -1, 0, 1, 2, ...} ‚Ä¢ Incluye negativos y cero
              </p>
            </div>
          </div>
          
          <div class="legend-item">
            <div class="legend-color" style="background: var(--accent-3);"></div>
            <div>
              <strong>‚Ñö - Racionales</strong>
              <p class="text-muted" style="font-size: 0.9rem; margin-top: 4px;">
                Fracciones a/b ‚Ä¢ Decimales finitos/peri√≥dicos
              </p>
            </div>
          </div>
          
          <div class="legend-item">
            <div class="legend-color" style="background: var(--accent-4);"></div>
            <div>
              <strong>‚Ñù-‚Ñö - Irracionales</strong>
              <p class="text-muted" style="font-size: 0.9rem; margin-top: 4px;">
                œÄ, e, ‚àö2, œÜ ‚Ä¢ Decimales infinitos no peri√≥dicos
              </p>
            </div>
          </div>
        </div>
        
        <div style="margin-top: 25px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.03);">
          <h4>üí° Relaciones entre conjuntos:</h4>
          <ul style="color: var(--muted); padding-left: 20px; margin-top: 10px;">
            <li style="margin-bottom: 5px;">‚Ñï ‚äÇ ‚Ñ§ ‚äÇ ‚Ñö ‚äÇ ‚Ñù</li>
            <li style="margin-bottom: 5px;">‚Ñù = ‚Ñö ‚à™ (‚Ñù-‚Ñö)</li>
            <li style="margin-bottom: 5px;">‚Ñö ‚à© (‚Ñù-‚Ñö) = ‚àÖ</li>
          </ul>
        </div>
      </div>

      <!-- Panel de lista de puntos -->
      <div class="panel">
        <h3>üìã Puntos en la Recta</h3>
        <div class="points-list" id="pointsList">
          <div class="empty-state">
            <div>üìù</div>
            <p>Agrega n√∫meros para ver su clasificaci√≥n</p>
            <small class="text-muted">Los puntos se ordenan autom√°ticamente</small>
          </div>
        </div>
      </div>

      <!-- Panel calculadora de distancias -->
      <div class="panel">
        <h3>üìè Calculadora de Distancias</h3>
        <p class="text-muted" style="margin-bottom: 20px;">
          Selecciona dos puntos para calcular la distancia entre ellos
        </p>
        
        <div class="distance-inputs">
          <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Punto A:</label>
            <div class="custom-select" id="pointA-container">
              <div class="select-selected" id="pointA-selected">Selecciona un punto</div>
              <div class="select-items" id="pointA-items">
                <div data-value="">Selecciona un punto</div>
              </div>
            </div>
          </div>
          
          <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Punto B:</label>
            <div class="custom-select" id="pointB-container">
              <div class="select-selected" id="pointB-selected">Selecciona un punto</div>
              <div class="select-items" id="pointB-items">
                <div data-value="">Selecciona un punto</div>
              </div>
            </div>
          </div>
        </div>
        
        <button class="btn-primary" onclick="calculateDistance()" style="width: 100%; margin-top: 20px;">
          <span>üßÆ</span> Calcular Distancia
        </button>
        
        <div id="distanceResult">
          <div class="empty-state" style="padding: 30px 20px;">
            <div>üìê</div>
            <p>Los resultados aparecer√°n aqu√≠</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Notifications -->
  <div id="toastContainer"></div>

  <!-- JavaScript -->
  <script>
    // ==================== VARIABLES GLOBALES ====================
    let points = [];
    let currentRange = 10;
    let toastId = 0;

    // ==================== CONSTANTES MATEM√ÅTICAS ====================
    const CONSTANTS = {
      'œÄ': Math.PI,
      'pi': Math.PI,
      'e': Math.E,
      'œÜ': (1 + Math.sqrt(5)) / 2,
      'phi': (1 + Math.sqrt(5)) / 2,
      '‚àö2': Math.sqrt(2),
      '‚àö3': Math.sqrt(3),
      '‚àö5': Math.sqrt(5),
      '‚àö7': Math.sqrt(7),
      '‚àö8': Math.sqrt(8),
      '‚àö10': Math.sqrt(10),
      '‚àö13': Math.sqrt(13),
      '‚àö17': Math.sqrt(17)
    };

    // ==================== FUNCIONES DE UTILIDAD ====================
    function showToast(message, type = 'info', duration = 3000) {
      const container = document.getElementById('toastContainer');
      const id = `toast-${toastId++}`;
      
      const toast = document.createElement('div');
      toast.id = id;
      toast.className = `toast ${type}`;
      toast.innerHTML = `
        <span>${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚ÑπÔ∏è'}</span>
        <span>${message}</span>
      `;
      
      container.appendChild(toast);
      
      // Animar entrada
      setTimeout(() => toast.classList.add('show'), 10);
      
      // Eliminar despu√©s de la duraci√≥n
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => {
          if (toast.parentNode) {
            toast.parentNode.removeChild(toast);
          }
        }, 300);
      }, duration);
    }

    function parseNumber(input) {
      if (!input || typeof input !== 'string') {
        showToast('Entrada vac√≠a o no v√°lida', 'error');
        return null;
      }
      
      input = input.trim().replace(/\s+/g, '');
      
      // Verificar si es una constante directa
      if (CONSTANTS.hasOwnProperty(input)) {
        return CONSTANTS[input];
      }
      
      // Reemplazar constantes en la expresi√≥n
      let expression = input;
      for (const [symbol, value] of Object.entries(CONSTANTS)) {
        const regex = new RegExp(symbol.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
        expression = expression.replace(regex, `(${value})`);
      }
      
      // Manejar fracciones simples
      if (input.includes('/') && !input.includes('*') && !input.includes('+') && !input.includes('-', 1)) {
        const parts = input.split('/');
        if (parts.length === 2) {
          const num = parseFloat(parts[0]);
          const den = parseFloat(parts[1]);
          if (!isNaN(num) && !isNaN(den) && den !== 0) {
            return num / den;
          }
        }
      }
      
      // Manejar ra√≠ces cuadradas con ‚àö
      if (input.startsWith('‚àö')) {
        const radicand = parseFloat(input.slice(1));
        if (!isNaN(radicand) && radicand >= 0) {
          return Math.sqrt(radicand);
        }
      }
      
      // Manejar sqrt()
      if (input.includes('sqrt(')) {
        const match = input.match(/sqrt\(([^)]+)\)/);
        if (match) {
          const inner = match[1];
          const innerValue = parseNumber(inner);
          if (innerValue !== null && innerValue >= 0) {
            return Math.sqrt(innerValue);
          }
        }
      }
      
      // Manejar exponentes
      if (input.includes('^')) {
        const parts = input.split('^');
        if (parts.length === 2) {
          const base = parseNumber(parts[0]);
          const exponent = parseNumber(parts[1]);
          if (base !== null && exponent !== null) {
            return Math.pow(base, exponent);
          }
        }
      }
      
      // Evaluar expresi√≥n matem√°tica
      try {
        // Reemplazar ^ por ** para potencias
        expression = expression.replace(/\^/g, '**');
        
        // Verificar seguridad
        const safeChars = /^[0-9+\-*/.() ]+$/;
        if (safeChars.test(expression.replace(/[()]/g, ''))) {
          const result = Function('"use strict"; return (' + expression + ')')();
          if (typeof result === 'number' && !isNaN(result) && isFinite(result)) {
            return result;
          }
        }
      } catch (e) {
        // Continuar con otros m√©todos
      }
      
      // Intentar parsear como n√∫mero decimal
      const num = parseFloat(expression);
      if (!isNaN(num)) {
        return num;
      }
      
      showToast(`No se pudo interpretar: ${input}`, 'error');
      return null;
    }

    // ==================== CLASIFICACI√ìN DE N√öMEROS ====================
    function classifyNumber(num, originalInput) {
      if (num === null || typeof num !== 'number' || isNaN(num)) {
        return 'rationals';
      }
      
      // Verificar si es natural
      if (num > 0 && Number.isInteger(num)) {
        return 'naturals';
      }
      
      // Verificar si es entero
      if (Number.isInteger(num)) {
        return 'integers';
      }
      
      // Lista de constantes irracionales
      const irrationalConstants = Object.keys(CONSTANTS);
      if (irrationalConstants.includes(originalInput)) {
        return 'irrationals';
      }
      
      // Verificar si contiene sqrt
      if (originalInput.includes('sqrt(') || originalInput.includes('‚àö')) {
        return 'irrationals';
      }
      
      // Verificar si contiene constantes irracionales
      const hasIrrationalSymbol = Object.keys(CONSTANTS).some(symbol => 
        originalInput.includes(symbol)
      );
      
      if (hasIrrationalSymbol) {
        // Casos especiales que son racionales
        const specialCases = [
          /œÄ\/œÄ/, /pi\/pi/, /e\/e/, /œÜ\/œÜ/,
          /œÄ-œÄ/, /pi-pi/, /e-e/, /œÜ-œÜ/,
          /‚àö2\/‚àö2/, /‚àö3\/‚àö3/, /‚àö5\/‚àö5/
        ];
        
        const cleaned = originalInput.replace(/\s/g, '');
        if (specialCases.some(pattern => pattern.test(cleaned))) {
          if (num > 0 && Number.isInteger(num)) return 'naturals';
          if (Number.isInteger(num)) return 'integers';
          return 'rationals';
        }
        return 'irrationals';
      }
      
      // Por defecto, racional
      return 'rationals';
    }

    // ==================== FUNCIONES DE INTERFAZ ====================
    function addNumber() {
      const input = document.getElementById('numberInput').value;
      
      if (!input) {
        showToast('Por favor ingresa un n√∫mero', 'error');
        return;
      }
      
      const value = parseNumber(input);
      if (value === null) return;
      
      if (Math.abs(value) > currentRange) {
        showToast(`El n√∫mero debe estar entre -${currentRange} y ${currentRange}`, 'error');
        return;
      }
      
      // Verificar si ya existe
      const exists = points.some(p => Math.abs(p.value - value) < 0.0001);
      if (exists) {
        showToast('Este n√∫mero ya est√° en la recta', 'warning');
        return;
      }
      
      const classification = classifyNumber(value, input);
      const point = {
        value: value,
        originalInput: input,
        classification: classification,
        id: Date.now() + Math.random()
      };
      
      points.push(point);
      document.getElementById('numberInput').value = '';
      updateDisplay();
      
      showToast(`‚úÖ ${input} agregado como ${classification}`, 'success');
    }

    function addPresetNumber(input) {
      const inputElem = document.getElementById('numberInput');
      inputElem.value = input;
      addNumber();
    }

    function clearAll() {
      if (points.length === 0) {
        showToast('No hay puntos para eliminar', 'info');
        return;
      }
      
      if (confirm('¬øEst√°s seguro de que quieres eliminar todos los puntos?')) {
        points = [];
        updateDisplay();
        showToast('Todos los puntos han sido eliminados', 'success');
      }
    }

    function showExamples() {
      const examples = [
        "sqrt(2)",
        "œÄ",
        "1/3",
        "2*œÄ",
        "e",
        "œÜ",
        "-‚àö2",
        "3.1416",
        "‚àö5",
        "e^2"
      ];
      
      const exampleText = examples.join(', ');
      showToast(`Ejemplos: ${exampleText}`, 'info', 5000);
    }

    // ==================== ZOOM ====================
    function zoomIn() {
      if (currentRange > 2) {
        currentRange -= 2;
        updateDisplay();
        document.getElementById('rangeValue').textContent = currentRange;
      }
    }

    function zoomOut() {
      if (currentRange < 20) {
        currentRange += 2;
        updateDisplay();
        document.getElementById('rangeValue').textContent = currentRange;
      }
    }

    // ==================== VISUALIZACI√ìN ====================
    function drawNumberLine() {
      const container = document.getElementById('numberLine');
      container.innerHTML = '';
      
      // L√≠nea base
      const line = document.createElement('div');
      line.className = 'line';
      container.appendChild(line);
      
      // Marcas y etiquetas
      const tickSpacing = currentRange <= 10 ? 1 : currentRange <= 20 ? 2 : 5;
      const totalTicks = (currentRange * 2) / tickSpacing;
      
      for (let i = 0; i <= totalTicks; i++) {
        const value = -currentRange + (i * tickSpacing);
        const percentage = (i / totalTicks) * 90 + 5;
        
        const tick = document.createElement('div');
        tick.className = 'tick';
        tick.style.left = `${percentage}%`;
        container.appendChild(tick);
        
        const label = document.createElement('div');
        label.className = value === 0 ? 'tick-label main' : 'tick-label';
        label.style.left = `${percentage}%`;
        label.textContent = value;
        container.appendChild(label);
      }
      
      // Puntos
      points.forEach((point, index) => {
        const percentage = ((point.value + currentRange) / (2 * currentRange)) * 90 + 5;
        
        const pointElem = document.createElement('div');
        pointElem.className = `number-point ${point.classification}`;
        pointElem.style.left = `${percentage}%`;
        pointElem.dataset.index = index;
        
        const pointLabel = document.createElement('div');
        pointLabel.className = 'point-label';
        pointLabel.textContent = `${point.originalInput} ‚âà ${point.value.toFixed(3)}`;
        pointElem.appendChild(pointLabel);
        
        const valueSpan = document.createElement('span');
        valueSpan.className = 'point-value';
        valueSpan.textContent = point.value.toFixed(2);
        pointElem.appendChild(valueSpan);
        
        pointElem.onclick = (e) => {
          e.stopPropagation();
          removePoint(index);
        };
        
        container.appendChild(pointElem);
      });
    }

    function removePoint(index) {
      const point = points[index];
      if (confirm(`¬øEliminar ${point.originalInput}?`)) {
        points.splice(index, 1);
        updateDisplay();
        showToast(`Punto ${point.originalInput} eliminado`, 'success');
      }
    }

    function updatePointsList() {
      const container = document.getElementById('pointsList');
      
      if (points.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <div>üìù</div>
            <p>Agrega n√∫meros para ver su clasificaci√≥n</p>
            <small class="text-muted">Los puntos se ordenan autom√°ticamente</small>
          </div>
        `;
        return;
      }
      
      const sortedPoints = [...points].sort((a, b) => a.value - b.value);
      
      container.innerHTML = sortedPoints.map((point, index) => `
        <div class="point-item ${point.classification} slide-in" style="animation-delay: ${index * 50}ms">
          <div>
            <strong>${point.originalInput}</strong>
            <div class="text-muted" style="font-size: 0.9rem; margin-top: 2px;">
              ‚âà ${point.value.toFixed(6)}
            </div>
          </div>
          <div style="text-align: right;">
            <div style="font-weight: 600; color: var(--${point.classification === 'naturals' ? 'accent-1' : point.classification === 'integers' ? 'accent-2' : point.classification === 'rationals' ? 'accent-3' : 'accent-4'})">
              ${point.classification === 'naturals' ? '‚Ñï' : point.classification === 'integers' ? '‚Ñ§' : point.classification === 'rationals' ? '‚Ñö' : '‚Ñù-‚Ñö'}
            </div>
            <div class="text-muted" style="font-size: 0.85rem; margin-top: 2px;">
              ${point.value > 0 ? '+' : ''}${point.value.toFixed(3)}
            </div>
          </div>
        </div>
      `).join('');
    }

    function updateDistanceSelectors() {
      const updateSelector = (selector) => {
        const selected = document.getElementById(`${selector}-selected`);
        const items = document.getElementById(`${selector}-items`);
        const container = document.getElementById(`${selector}-container`);
        
        items.innerHTML = '<div data-value="">Selecciona un punto</div>';
        
        if (points.length === 0) {
          selected.textContent = 'Selecciona un punto';
          container.dataset.value = '';
          return;
        }
        
        points.forEach((point, index) => {
          const option = document.createElement('div');
          option.dataset.value = index;
          option.textContent = `${point.originalInput} (${point.value.toFixed(3)})`;
          option.onclick = () => {
            selected.textContent = option.textContent;
            container.dataset.value = index;
            items.classList.remove('show');
          };
          items.appendChild(option);
        });
      };
      
      updateSelector('pointA');
      updateSelector('pointB');
    }

    function calculateDistance() {
      const pointAIndex = document.getElementById('pointA-container').dataset.value;
      const pointBIndex = document.getElementById('pointB-container').dataset.value;
      const resultDiv = document.getElementById('distanceResult');
      
      if (pointAIndex === '' || pointBIndex === '') {
        resultDiv.innerHTML = `
          <div class="empty-state">
            <div>‚ö†Ô∏è</div>
            <p>Selecciona ambos puntos</p>
          </div>
        `;
        return;
      }
      
      if (pointAIndex === pointBIndex) {
        resultDiv.innerHTML = `
          <div class="empty-state">
            <div>‚ö†Ô∏è</div>
            <p>Selecciona dos puntos diferentes</p>
          </div>
        `;
        return;
      }
      
      const pointA = points[pointAIndex];
      const pointB = points[pointBIndex];
      const distance = Math.abs(pointA.value - pointB.value);
      
      resultDiv.innerHTML = `
        <div class="distance-result fade-in">
          <h4>üìè Distancia Calculada</h4>
          <p style="margin: 15px 0; font-size: 1.1rem;">
            d(${pointA.originalInput}, ${pointB.originalInput})
          </p>
          <p style="font-size: 1.4rem; color: var(--gold); margin: 10px 0;">
            = |${pointA.value.toFixed(3)} ‚àí ${pointB.value.toFixed(3)}|
          </p>
          <p style="font-size: 1.6rem; font-weight: 800; margin: 15px 0; color: var(--text);">
            = ${distance.toFixed(6)}
          </p>
          <p class="text-muted" style="margin-top: 15px;">
            La distancia es el valor absoluto de la diferencia
          </p>
        </div>
      `;
    }

    // ==================== EVENT LISTENERS ====================
    document.addEventListener('DOMContentLoaded', function() {
      // Enter para agregar n√∫meros
      document.getElementById('numberInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') addNumber();
      });
      
      // Dropdowns
      ['pointA', 'pointB'].forEach(selector => {
        const selected = document.getElementById(`${selector}-selected`);
        const items = document.getElementById(`${selector}-items`);
        
        selected.addEventListener('click', function(e) {
          e.stopPropagation();
          const isOpen = items.classList.contains('show');
          
          // Cerrar todos los dropdowns
          document.querySelectorAll('.select-items').forEach(item => {
            item.classList.remove('show');
          });
          
          // Abrir este si estaba cerrado
          if (!isOpen) {
            items.classList.add('show');
          }
        });
      });
      
      // Cerrar dropdowns al hacer clic fuera
      document.addEventListener('click', function() {
        document.querySelectorAll('.select-items').forEach(item => {
          item.classList.remove('show');
        });
      });
      
      // Inicializar
      updateDisplay();
      showToast('¬°Bienvenido al Visualizador de la Recta Num√©rica!', 'info', 2000);
    });

    function updateDisplay() {
      drawNumberLine();
      updatePointsList();
      updateDistanceSelectors();
    }

    // Ejemplos iniciales
    setTimeout(() => {
      if (points.length === 0) {
        // Agregar algunos ejemplos iniciales
        ['œÄ', '‚àö2', '1/3', '-2'].forEach(num => {
          const value = parseNumber(num);
          if (value !== null && Math.abs(value) <= currentRange) {
            points.push({
              value: value,
              originalInput: num,
              classification: classifyNumber(value, num),
              id: Date.now() + Math.random()
            });
          }
        });
        updateDisplay();
      }
    }, 1000);
  </script>
  <!-- Bot√≥n flotante de regreso -->
<div style="position: fixed; bottom: 20px; right: 20px; z-index: 1000;">
  <a href="/index.html" 
     style="display: inline-flex; align-items: center; gap: 8px; padding: 12px 20px; 
            background: linear-gradient(180deg, var(--gold-bright), var(--gold)); 
            color: #0b0b0b; border-radius: 10px; text-decoration: none; font-weight: 600;
            box-shadow: 0 8px 20px rgba(201,168,106,0.12); transition: all var(--transition);">
    <span>‚Üê</span> Volver
  </a>
</div>
</body>
</html>